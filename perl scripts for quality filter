zcat gz_file | perl -ne 'chomp;$first_line  = $_;$second_line = <STDIN>;$third_line  = <STDIN>;$#forth_line  = <STDIN>;chomp $forth_line;map {$score5++ if ( ord($_) - 33 ) <= 5;$score10++ if ( ord($_) - 33 ) < 10;$score13++ if ( ord($_) - 33 ) < 13;$score += ord($_) - 33;} split( "", $forth_line );chomp $second_line;$top20 = substr( $second_line, 0, 20 );map { $scoreN++ if $_ eq "N"; } split( "", $top20 );$avarage = $score / ( length $forth_line );$percentage5=$score5/(length $forth_line);$percentage10 = $score10 / ( length $forth_line );$percentage13 = $score13 / ( length $forth_line );chomp $first_line;chomp $third_line;print "$first_line\n$second_line\n$third_line\n$forth_line\n"  if ( $avarage >= 20 && $scoreN == 0 && $percentage5< 0.5 && $percentage10 <= 0.1 && $percentage13 <= 0.2 );$score = 0;$score13 = 0;$score10 = 0;$scoreN  = 0;$score5 = 0;' >>output.fq;
